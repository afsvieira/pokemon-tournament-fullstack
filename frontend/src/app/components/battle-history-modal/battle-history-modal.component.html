<!-- Battle History Modal - displays Pokemon battle records and statistics -->
<div class="modal d-block" tabindex="-1" style="background: rgba(0,0,0,0.85); backdrop-filter: blur(4px)" (click)="handleCloseModal()">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" (click)="$event.stopPropagation()">
    <div class="modal-content border-secondary" style="border-radius: 16px; max-height: 80vh">
      <!-- Modal header with Pokemon name and close button -->
      <div class="modal-header border-secondary">
        <h5 class="modal-title">
          <i class="fas fa-sword fs-5 me-2 text-muted"></i>
          {{ pokemon.name }} - Battle History
        </h5>
        <button type="button" class="btn-close" (click)="handleCloseModal()" aria-label="Close"></button>
      </div>

      <!-- Modal content with battle data -->
      <div class="modal-body">
      @if (hasBattleRecords) {
        <!-- Battle statistics summary -->
        <div class="mb-4">
          <div class="row g-3 text-center">
            <div class="col-4">
              <div class="card border-success border-opacity-25 p-3">
                <i class="fas fa-trophy fs-4 mb-2 text-success"></i>
                <div class="fw-semibold">{{ pokemon.wins }} Wins</div>
              </div>
            </div>
            <div class="col-4">
              <div class="card border-danger border-opacity-25 p-3">
                <i class="fas fa-times-circle fs-4 mb-2 text-danger"></i>
                <div class="fw-semibold">{{ pokemon.losses }} Losses</div>
              </div>
            </div>
            <div class="col-4">
              <div class="card border-secondary border-opacity-25 p-3">
                <i class="fas fa-minus-circle fs-4 mb-2 text-secondary"></i>
                <div class="fw-semibold">{{ pokemon.ties }} Ties</div>
              </div>
            </div>
          </div>
        </div>

        <hr class="border-secondary">

        <!-- Scrollable battle records list -->
        <div style="max-height: 300px; overflow-y: auto">
          @for (record of pokemonRecords; track $index) {
            <div class="card border-opacity-25 p-3 mb-2"
                 [ngClass]="record.className"
                 [style.border-left]="record.borderLeft">
              <div class="d-flex justify-content-between align-items-center">
                <!-- Battle opponent info -->
                <div class="flex-grow-1">
                  <div class="fw-semibold">vs {{ record.battle.opponentName }}</div>
                  <small class="text-muted">{{ record.battle.opponentType | titlecase }} type</small>
                </div>
                <!-- Battle result badge -->
                <div>
                  @if (record.isWin) {
                    <span class="badge bg-success">
                      <i class="fas fa-trophy me-1"></i>Victory
                    </span>
                  } @else if (record.isLoss) {
                    <span class="badge bg-danger">
                      <i class="fas fa-times-circle me-1"></i>Defeat
                    </span>
                  } @else {
                    <span class="badge bg-secondary">
                      <i class="fas fa-minus-circle me-1"></i>Draw
                    </span>
                  }
                </div>
              </div>
            </div>
          }
        </div>
      } @else {
        <!-- Empty state when no battle data -->
        <div class="text-center text-muted py-5">
          <i class="fas fa-info-circle fs-1 mb-3 text-info"></i>
          <p class="mb-0">No battle data available for this Pok√©mon.</p>
        </div>
      }
      </div>
    </div>
  </div>
</div>
