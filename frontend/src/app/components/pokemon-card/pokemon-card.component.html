<!-- Pokemon Card - displays Pokemon stats and battle information -->
<div class="card bg-dark border-secondary h-100 d-flex flex-column pokemon-card"
     style="min-height: 400px; border-width: 5px; border-radius: 16px; transition: all 0.3s ease">

  <!-- Card header with type icon and Pokemon info -->
  <div class="card-header bg-transparent border-0 pb-2">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        <!-- Type icon with tooltip -->
        <span class="d-inline-flex align-items-center justify-content-center me-2 bg-light rounded-circle"
              style="width: 36px; height: 36px; border: 2px solid rgba(255,255,255,0.3); transition: transform 0.2s ease"
              [title]="pokemon.type | titlecase"
              data-bs-toggle="tooltip">
          <i [ngClass]="getTypeIcon(pokemon.type)" [class]="'pokemon-type-' + pokemon.type"></i>
        </span>
        <span class="fw-bold fs-5 text-light text-capitalize">{{ pokemon.name }}</span>
      </div>
      <span class="text-muted fw-semibold" style="font-family: 'Courier New', monospace">
        #{{ pokemon.id.toString().padStart(3, '0') }}
      </span>
    </div>
  </div>

  <!-- Card body with proper padding -->
  <div class="card-body pt-0">
    <!-- Pokemon image section -->
    <div class="text-center mb-3">
      <div class="d-flex align-items-center justify-content-center mx-auto bg-dark border border-secondary rounded-3"
           style="width: 130px; height: 130px; box-shadow: inset 0 2px 4px rgba(255,255,255,0.05)">
        @if (pokemon.imageUrl) {
          <img [src]="pokemon.imageUrl" 
               [alt]="pokemon.name"
               class="img-fluid"
               style="max-width: 120px; max-height: 120px; object-fit: contain"
               loading="lazy">
        } @else {
          <span class="fs-1" style="filter: grayscale(20%) brightness(1.1)">ðŸŽ´</span>
        }
      </div>

      <!-- Base experience badge -->
      <div class="mt-2">
        <span class="xp-badge badge text-dark fw-bold px-3 py-2 rounded-pill">
          <i class="fas fa-star me-1"></i>
          <strong>{{ pokemon.baseExperience }} XP</strong>
        </span>
      </div>
    </div>

    <!-- Battle statistics grid -->
    <div class="flex-grow-1">
      <div class="row g-2 mb-2">
        <div class="col-6">
          <div class="stat-card card border-success border-opacity-25 text-center p-3">
            <i class="fas fa-trophy text-success mb-1"></i>
            <small class="d-block text-uppercase fw-semibold text-muted" style="font-size: 0.7rem; letter-spacing: 0.05em">Wins</small>
            <span class="fw-bold text-success">{{ pokemon.wins }}</span>
          </div>
        </div>
        <div class="col-6">
          <div class="stat-card card border-danger border-opacity-25 text-center p-3">
            <i class="fas fa-times-circle text-danger mb-1"></i>
            <small class="d-block text-uppercase fw-semibold text-muted" style="font-size: 0.7rem; letter-spacing: 0.05em">Losses</small>
            <span class="fw-bold text-danger">{{ pokemon.losses }}</span>
          </div>
        </div>
      </div>
      <div class="row g-2">
        <div class="col-6">
          <div class="stat-card card border-secondary border-opacity-25 text-center p-3">
            <i class="fas fa-minus-circle text-secondary mb-1"></i>
            <small class="d-block text-uppercase fw-semibold text-muted" style="font-size: 0.7rem; letter-spacing: 0.05em">Ties</small>
            <span class="fw-bold text-secondary">{{ pokemon.ties }}</span>
          </div>
        </div>
        <div class="col-6">
          <div class="stat-card card border-warning border-opacity-25 text-center p-3">
            <i class="fas fa-percentage text-warning mb-1"></i>
            <small class="d-block text-uppercase fw-semibold text-muted" style="font-size: 0.7rem; letter-spacing: 0.05em">Win Rate</small>
            <span class="fw-bold text-warning">{{ pokemon.winRate }}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Battle history button -->
  <div class="card-footer bg-transparent border-0 pt-0">
    <button type="button"
            class="btn btn-outline-secondary btn-sm w-100"
            (click)="openModal()">
      <i class="fas fa-eye me-1"></i>
      View Battles
    </button>
  </div>
</div>

<!-- Battle History Modal Component -->
@if (showModal) {
  <app-battle-history-modal
    [pokemon]="pokemon"
    (closeModal)="showModal = false">
  </app-battle-history-modal>
}
